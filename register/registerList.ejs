<%- include ("../_header") %>
  <div class="page-breadcrumb">
    <div class="row">
      <div class="col-md-5 align-self-center">
        <h3 class="page-title">ลงทะเบียน</h3>
        <div class="d-flex align-items-center mt-1">
          <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
              <li class="breadcrumb-item"><a href="#">แดชบอร์ด</a></li>
              <li class="breadcrumb-item active" aria-current="page">ลงทะเบียน</li>
            </ol>
          </nav>
        </div>
      </div>
      <div class="col-md-7 justify-content-end align-self-center d-none d-md-flex">
        <div class="d-flex">
          <div class="dropdown me-2">
            <button class="btn btn-secondary dropdown-toggle show_selectdropdown" type="button" id="dropdownMenuButton"
              data-bs-toggle="dropdown" aria-expanded="false">
              เจ้าหน้าที่
            </button>
            <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton">
              <li><a class="dropdown-item" onclick="selectpersonnel()" href="#">เจ้าหน้าที่ <span
                    class="badge badge-pill bg-success">
                    <%if(personnel){%>
                      <%=personnel.length%>
                        <%}else{%>
                          0
                          <%}%>
                  </span></a></li>
              <li><a class="dropdown-item" onclick="selectusers()" href="#">ประชาชน
                  <span class="badge badge-pill bg-success">
                    <%if(users){%>
                      <%=users.length%>
                        <%}else{%>
                          0
                          <%}%>
                  </span>
                </a></li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>


  <div class="container-fluid">
    <div class="row">
      <div class="col-12" id="hiddenpersonel">
        <div class="card">
          <div class="d-flex border-bottom title-part-padding align-items-center">
            <div>
              <h4 class="card-title mb-0">รายชื่อเจ้าหน้าที่</h4>
            </div>
          </div>

          <div class="card-body">
            <div class="table-responsive">
              <div id="zero_config_wrapper" class="dataTables_wrapper container-fluid dt-bootstrap4">
                <div class="row">
                  <div class="col-sm-12">
                    <table id="zero_config" class="table table-striped table-bordered dataTable" role="grid"
                      aria-describedby="zero_config_info">
                      <thead>
                        <tr role="row">
                          <th class="sorting_asc" tabindex="0" aria-controls="zero_config" rowspan="1" colspan="1"
                            aria-sort="ascending" aria-label="Name: activate to sort column descending"
                            style="width: 0px;">ลำดับ</th>
                          <th class="sorting" tabindex="0" aria-controls="zero_config" rowspan="1" colspan="1"
                            aria-label="Position: activate to sort column ascending" style="width: 0px;">ชื่อ/นามสกุล
                          </th>
                          <th class="sorting" tabindex="0" aria-controls="zero_config" rowspan="1" colspan="1"
                            aria-label="Position: activate to sort column ascending" style="width: 0px;">เลขบัตรประชาชน
                          </th>
                          <th class="sorting" tabindex="0" aria-controls="zero_config" rowspan="1" colspan="1"
                            aria-label="Position: activate to sort column ascending" style="width: 0px;">หน่วยงาน
                          </th>
                          <th class="sorting" tabindex="0" aria-controls="zero_config" rowspan="1" colspan="1"
                            aria-label="Office: activate to sort column ascending" style="width: 0px;">เบอร์ติดต่อ</th>
                          <th class="sorting" tabindex="0" aria-controls="zero_config" rowspan="1" colspan="1"
                            aria-label="Office: activate to sort column ascending" style="width: 0px;">แสดง</th>
                        </tr>
                      </thead>
                      <tbody>
                        <%if(personnel){%>
                          <% for(var i=0; i<personnel.length;i++ ){ %>
                            <tr>
                              <td>
                                <%= i+1 %>
                              </td>
                              <td>
                                <%= personnel[i].fname_ps%>
                                  <%= personnel[i].lname_ps%>
                              </td>
                              <td>
                                <%= personnel[i].idcard_ps%>
                              </td>
                              <td>
                                <%= personnel[i].name_pst%>
                              </td>
                              <td>
                                <%= personnel[i].phone_ps%>
                              </td>
                              <td>
                                <a class="btn btn-success"
                                  onclick="return confirm('ยืนยันการอนุมัติ ชื่อ:<%= personnel[i].fname_ps%> <%= personnel[i].lname_ps%> เจ้าหน้าที่:(<%= personnel[i].name_pst%>)');"
                                  href="/register/person/personnel<%= personnel[i].idpersonnel%>"><i
                                    class="icon_check_alt2"></i> อนุมัติ</a>
                                <a class="btn btn-danger"
                                  onclick="return confirm('ไม่อนุมัติ ชื่อ:<%= personnel[i].fname_ps%> <%= personnel[i].lname_ps%> เจ้าหน้าที่:(<%= personnel[i].name_pst%>)');"
                                  href="/register/person/personnelCancel/<%= personnel[i].idpersonnel%>"><i
                                    class="icon_close_alt2"></i> ไม่อนุมัติ</a>
                              </td>
                            </tr>
                            <%}%>
                              <%}%>
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="col-12" id="hiddenusers">
        <div class="card">
          <div class="d-flex border-bottom title-part-padding align-items-center">
            <div>
              <h4 class="card-title mb-0">รายชื่อประชาชน</h4>
            </div>
          </div>

          <div class="card-body">
            <div class="table-responsive">
              <div id="zero_config_wrapper" class="dataTables_wrapper container-fluid dt-bootstrap4">
                <div class="row">
                  <div class="col-sm-12">
                    <table id="zero_config" class="table table-striped table-bordered dataTable" role="grid"
                      aria-describedby="zero_config_info">
                      <thead>
                        <tr role="row">
                          <th class="sorting_asc" tabindex="0" aria-controls="zero_config" rowspan="1" colspan="1"
                            aria-sort="ascending" aria-label="Name: activate to sort column descending"
                            style="width: 0px;">ลำดับ</th>
                          <th class="sorting" tabindex="0" aria-controls="zero_config" rowspan="1" colspan="1"
                            aria-label="Position: activate to sort column ascending" style="width: 0px;">ชื่อ/นามสกุล
                          </th>
                          <th class="sorting" tabindex="0" aria-controls="zero_config" rowspan="1" colspan="1"
                            aria-label="Position: activate to sort column ascending" style="width: 0px;">เลขบัตรประชาชน
                          </th>
                          <th class="sorting" tabindex="0" aria-controls="zero_config" rowspan="1" colspan="1"
                            aria-label="Position: activate to sort column ascending" style="width: 0px;">ที่อยู่
                          </th>
                          <th class="sorting" tabindex="0" aria-controls="zero_config" rowspan="1" colspan="1"
                            aria-label="Office: activate to sort column ascending" style="width: 0px;">เพศ</th>
                          <th class="sorting" tabindex="0" aria-controls="zero_config" rowspan="1" colspan="1"
                            aria-label="Office: activate to sort column ascending" style="width: 0px;">เบอร์ติดต่อ</th>
                          <th class="sorting" tabindex="0" aria-controls="zero_config" rowspan="1" colspan="1"
                            aria-label="Office: activate to sort column ascending" style="width: 0px;">แสดง</th>
                        </tr>
                      </thead>
                      <tbody>
                        <%if(users){%>
                          <% for(var i=0; i<users.length;i++ ){ %>
                            <tr>
                              <td>
                                <%= i+1 %>
                              </td>
                              <td>
                                <%= users[i].fname_us%>
                                  <%= users[i].lname_us%>
                              </td>
                              <td>
                                <%= users[i].idcard_us%>
                              </td>
                              <td>
                                <%= users[i].address_us%>
                              </td>
                              <td>
                                <%if(users[i].sex_us==1){%>
                                  ชาย
                                  <%}else{%>
                                    หญิง
                                    <%}%>
                              </td>
                              <td>
                                <%= users[i].phone_us%>
                              </td>
                              <td>
                                <a class="btn btn-success"
                                  onclick="return confirm('ยืนยันการอนุมัติ ชื่อ:<%= users[i].fname_us%> <%= users[i].lname_us%> รหัสประชาชน:(<%= users[i].idcard_us%>)');"
                                  href="/register/person/user<%= users[i].idusers%>"><i class="icon_check_alt2"></i>
                                  อนุมัติ</a>
                                <a class="btn btn-danger"
                                  onclick="return confirm('ยืนยันการอนุมัติ ชื่อ:<%= users[i].fname_us%> <%= users[i].lname_us%> รหัสประชาชน:(<%= users[i].idcard_us%>)');"
                                  href="/register/person/userCancel/<%= users[i].idusers%>"><i
                                    class="icon_close_alt2"></i> ไม่อนุมัติ</a>
                              </td>
                            </tr>
                            <%}%>
                              <%}%>
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
  <script>
    $(document).ready(function () {
      $('.table').DataTable();
      $("#hiddenpersonel").hide()
    });
  </script>
  <script>
    function submitalert() {
      Swal.fire({
        type: 'success',
        title: 'อนุมัติเรียบร้อย',
        showConfirmButton: false,
        timer: 1500
      }).then(() => {
        $("#submitalert").submit();
      })
    }

    function selectusers() {
      $("#hiddenpersonel").hide()
      $("#hiddenusers").show()
      $(".show_selectdropdown").html("ประชาชน ")
    }
    function selectpersonnel() {
      $("#hiddenpersonel").show()
      $("#hiddenusers").hide()
      $(".show_selectdropdown").html("เจ้าหน้าที่ ")
    }
  </script>

  <%- include ("../_footer") %>